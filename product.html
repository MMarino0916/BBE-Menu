<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bobby Black Exclusive | Product</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root{--bg:#fafafa;--text:#111;--muted:#666;--card:#fff;--border:#eaeaea;--shadow:0 10px 28px rgba(0,0,0,.10);}
    *{box-sizing:border-box}
    body{font-family:Arial,sans-serif;margin:0;background:var(--bg);color:var(--text)}
    header{text-align:center;padding:26px 16px 12px}
    .brand-logo{max-width:260px;width:72%;margin:0 auto;display:block}
    .subtitle{margin-top:10px;font-size:13px;letter-spacing:2px;text-transform:uppercase;color:var(--muted)}
    .wrap{max-width:980px;margin:0 auto;padding:16px 16px 46px}
    .back{display:inline-block;margin-bottom:16px;text-decoration:none;font-weight:900;color:#111}

    .card{
      background:var(--card);
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      border-radius:18px;
      padding:16px;
    }
    .title{font-size:22px;font-weight:900}
    .meta{margin-top:6px;color:#444;font-size:13px}
    .sale{color:#b00000;font-weight:900;margin-left:6px;font-size:13px}

    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:14px}
    .imgwrap{
      background:#f4f4f4;border:1px solid #eee;border-radius:16px;
      min-height:260px;display:flex;align-items:center;justify-content:center;overflow:hidden;
    }
    .imgwrap img{max-width:100%;height:auto;display:block}
    .desc{color:#333;font-size:14px;line-height:1.5}

    .prices{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
    .pill{background:#f4f4f4;border:1px solid #eee;border-radius:999px;padding:8px 12px;font-weight:900;font-size:13px}

    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{border:0;border-radius:999px;padding:12px 16px;font-weight:900;cursor:pointer}
    .btn.add{background:#111;color:#fff}
    .btn.back{background:#eee;color:#111}

    footer{text-align:center;padding:18px;font-size:14px;color:var(--muted)}

    /* Age gate */
    .age-gate{position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,.72);display:none;align-items:center;justify-content:center;padding:20px}
    .age-gate.show{display:flex}
    .age-card{background:#fff;max-width:420px;width:100%;border-radius:18px;padding:22px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.35)}
    .age-title{font-size:22px;font-weight:900;margin-bottom:8px}
    .age-actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px}
    .age-btn{border:0;border-radius:999px;padding:12px;font-weight:900;cursor:pointer}
    .age-btn.yes{background:#111;color:#fff}
    .age-btn.no{background:#eee;color:#111}

    @media(max-width:900px){
      .grid{grid-template-columns:1fr}
      .brand-logo{width:86%}
    }
  </style>

  <script src="cart.js"></script>
</head>

<body>

<!-- Age Gate -->
<div id="ageGate" class="age-gate">
  <div class="age-card">
    <div class="age-title">21+ Only</div>
    <p>Please confirm you are 21 years of age or older.</p>
    <div class="age-actions">
      <button class="age-btn yes" id="ageYes">I‚Äôm 21+</button>
      <button class="age-btn no" id="ageNo">No</button>
    </div>
  </div>
</div>

<header>
  <img src="bobby-black.png" class="brand-logo" alt="Bobby Black Exclusive" />
  <div class="subtitle">Product Details</div>
</header>

<div class="wrap">
  <a href="index.html" class="back">‚Üê Back to Menu</a>

  <div class="card">
    <div class="title" id="pTitle">Loading‚Ä¶</div>
    <div class="meta" id="pMeta"></div>

    <div class="grid">
      <div class="imgwrap" id="pImgWrap">
        <div style="color:#777;font-weight:900;">No Image</div>
      </div>

      <div>
        <div class="desc" id="pDesc"></div>
        <div class="prices" id="pPrices"></div>

        <div class="actions">
          <button class="btn add" id="addToCartBtn">Add to Cart</button>
          <button class="btn back" id="backBtn">Back</button>
        </div>

        <div style="margin-top:12px;color:#666;font-size:12px;">
          Cart is for screenshot/sharing only ‚Äî no checkout.
        </div>
      </div>
    </div>
  </div>
</div>

<footer>Updated Weekly ‚Ä¢ 21+</footer>

<script>
  BBE_CART.mountCartPill();

  // Age gate
  (function(){
    const KEY="bbe_age_verified";
    const gate=document.getElementById("ageGate");
    if(localStorage.getItem(KEY)!=="true"){gate.classList.add("show")}
    document.getElementById("ageYes").onclick=()=>{localStorage.setItem(KEY,"true");gate.classList.remove("show")}
    document.getElementById("ageNo").onclick=()=>{window.location.href="https://www.google.com"}
  })();

  function getId(){
    const p=new URLSearchParams(location.search);
    return p.get("id");
  }
  function money(n){ return "$"+Number(n).toFixed(0) }

  const id=getId();

  document.getElementById("backBtn").onclick=()=>{
    history.length>1 ? history.back() : location.href="index.html";
  };

  fetch("content/products.json",{cache:"no-store"})
    .then(r=>r.json())
    .then(data=>{
      const items=(data.items||[]);
      const item=items.find(x=>x.id===id);

      if(!item){
        document.getElementById("pTitle").textContent="Not found";
        document.getElementById("pMeta").textContent="This item does not exist.";
        document.getElementById("addToCartBtn").style.display="none";
        return;
      }

      // Title + meta
      document.getElementById("pTitle").textContent=item.name;
      const metaBits=[];
      if(item.category) metaBits.push(item.category);
      if(item.subcategory) metaBits.push(item.subcategory);
      document.getElementById("pMeta").textContent=metaBits.join(" ‚Ä¢ ");

      // Image
      if(item.image){
        const wrap=document.getElementById("pImgWrap");
        wrap.innerHTML="";
        const img=document.createElement("img");
        img.src=item.image;
        img.alt=item.name;
        wrap.appendChild(img);
      }

      // Description
      document.getElementById("pDesc").textContent=item.description || "";

      // Prices
      const prices=document.getElementById("pPrices");
      prices.innerHTML="";

      if(item.category==="Flower"){
        const order=["g3_5","g7","g14","g28"];
        const labels={g3_5:"3.5g",g7:"7g",g14:"14g",g28:"28g"};
        order.forEach(k=>{
          const available=item.availability?.[k]!==false;
          const price=item.prices?.[k];
          const pill=document.createElement("div");
          pill.className="pill";
          pill.textContent = labels[k] + ": " + (available && price ? money(price) : "N/A");
          prices.appendChild(pill);
        });
      } else if(item.category==="Concentrates"){
        const pg=item.prices?.perGram;
        const pill=document.createElement("div");
        pill.className="pill";
        pill.textContent = "$ / gram: " + (pg ? money(pg) : "N/A");
        prices.appendChild(pill);
      } else if(item.category==="Accessories"){
        const s=item.prices?.single;
        const pill=document.createElement("div");
        pill.className="pill";
        pill.textContent = "Price: " + (s ? money(s) : "N/A");
        prices.appendChild(pill);
      }

      // Sale badge
      if(item.sale){
        const t=document.getElementById("pTitle");
        const s=document.createElement("span");
        s.className="sale";
        s.textContent="üö® SALE";
        t.appendChild(s);
      }

      // Add to cart uses the same flow (Flower triggers size picker)
      document.getElementById("addToCartBtn").onclick=()=>{
        BBE_CART.openAddFlow(item.id, "content/products.json");
      };
    });
</script>

</body>
</html>
