<!DOCTYPE html>
<!-- Updated: slim Flowery-style header/nav and BBE favicon. -->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bobby Black Exclusive | Concentrates</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="images/BBE-Favicon.png">

  <style>
    :root{
      --bg:#fafafa;
      --text:#111;
      --muted:#666;
      --card:#fff;
      --border:rgba(0,0,0,0.10);
      --shadow:0 10px 28px rgba(0,0,0,.10);

      --black:#0E0E0E;
      --gold:#D4AF37;
      --gold-soft:rgba(212,175,55,0.35);
      --gold-faint:rgba(212,175,55,0.18);
    }
    *{box-sizing:border-box}
    body{font-family:Arial,sans-serif;margin:0;background:var(--bg);color:var(--text)}

    .site-header{
      background:#000;
      border-bottom:1px solid rgba(255,255,255,0.16);
      min-height:64px;
      display:flex;
      align-items:center;
      position:sticky;
      top:0;
      z-index:1000;
    }
    .header-inner{
      width:min(1200px, 100%);
      margin:0 auto;
      padding:10px 16px;
      display:grid;
      grid-template-columns:auto 1fr auto;
      align-items:center;
      gap:18px;
    }
    .brand-logo{
      height:34px;
      width:auto;
      display:block;
    }
    .main-nav{
      display:flex;
      gap:18px;
      align-items:center;
      flex-wrap:wrap;
    }
    .main-nav a{
      font-size:12px;
      letter-spacing:0.04em;
      text-transform:uppercase;
      text-decoration:none;
      color:#fff;
      opacity:0.92;
      transition:opacity .18s ease, color .18s ease;
    }
    .main-nav a:hover,.main-nav a:focus-visible{opacity:1;color:#d9d9d9}
    .header-search input[type="search"]{
      width:min(520px, 52vw);
      height:38px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.28);
      background:rgba(255,255,255,0.06);
      color:#fff;
      padding:0 14px;
      font-size:12px;
      letter-spacing:0.02em;
      outline:none;
      text-transform:uppercase;
    }
    .header-search input[type="search"]::placeholder{color:rgba(255,255,255,0.66)}
    .header-search input[type="search"]:focus{
      border-color:rgba(255,255,255,0.48);
      background:rgba(255,255,255,0.12);
    }

    .subtitle{
      text-align:center;
      margin:14px 0 0;
      font-size:12px;
      letter-spacing:3px;
      text-transform:uppercase;
      color:var(--muted);
      font-weight:900;
    }

    .wrap{max-width:1100px;margin:0 auto;padding:16px 16px 26px}

    .back{
      display:inline-block;
      margin-bottom:16px;
      text-decoration:none;
      font-weight:900;
      color:#111;
      border-bottom:1px solid transparent;
      transition:color .18s ease, border-color .18s ease;
    }
    .back:hover{color:var(--gold);border-color:var(--gold)}

    .group{margin-bottom:36px}
    .group-title{
      font-size:18px;
      font-weight:900;
      margin-bottom:10px;
      display:inline-block;
      padding-bottom:4px;
      border-bottom:2px solid rgba(212,175,55,.55);
    }

    .item{
      background:var(--card);
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      border-radius:14px;
      padding:14px;
      margin-top:12px;
      cursor:pointer;
      transition:transform .08s ease, border-color .18s ease, box-shadow .18s ease;
      display:flex;
      gap:14px;
      align-items:center;
    }
    .item:hover{
      transform:translateY(-2px);
      border-color:var(--gold-soft);
      box-shadow:0 16px 34px rgba(0,0,0,.12);
    }

    .thumb{
      width:92px;height:92px;flex:0 0 92px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#f3f3f3;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      transition:border-color .18s ease;
    }
    .item:hover .thumb{border-color:var(--gold-soft)}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .noimg{
      font-size:11px;
      color:var(--muted);
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:1px;
    }

    .item-main{flex:1 1 auto; min-width:0;}
    .item-name{font-weight:900;font-size:16px}
    .sale{color:#b00000;font-weight:900;margin-left:6px;font-size:13px}

    .prices{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px;font-size:13px}
    .price{
      background:#f4f4f4;
      border:1px solid rgba(0,0,0,0.08);
      border-radius:999px;
      padding:6px 10px;
      transition:border-color .18s ease;
    }
    .item:hover .price{border-color:var(--gold-soft)}

    .actions-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .btn{
      border:1px solid rgba(0,0,0,0.12);
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      cursor:pointer;
      background:#fff;
      transition:all .18s ease;
    }

    /* Add button: black normally, gold border on hover */
    .btn.add{
      background:var(--black);
      color:#fff;
      border-color:var(--black);
    }
    .btn.add:hover{
      background:#fff;
      color:var(--black);
      border-color:var(--gold);
    }

    /* View button: light normally, gold border on hover */
    .btn.view{
      background:#eee;
      color:#111;
      border-color:#eee;
    }
    .btn.view:hover{
      background:#fff;
      color:var(--gold);
      border-color:var(--gold);
    }

    /* ‚úÖ Footer with gold divider line */
    footer{
      text-align:center;
      padding:18px 14px 28px;
      font-size:11px;
      color:#777;
      background:#fff;
      border-top:1px solid rgba(0,0,0,0.06);
      position:relative;
    }
    footer:before{
      content:"";
      position:absolute;
      top:0;
      left:0;
      right:0;
      height:1px;
      background:linear-gradient(90deg, rgba(212,175,55,0), rgba(212,175,55,.55), rgba(212,175,55,0));
    }

    /* Age gate */
    .age-gate{position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,.72);display:none;align-items:center;justify-content:center;padding:20px}
    .age-gate.show{display:flex}
    .age-card{
      background:#fff;
      max-width:460px;width:100%;
      border-radius:18px;
      padding:22px;
      text-align:center;
      box-shadow:0 20px 60px rgba(0,0,0,.35);
      border:1px solid rgba(0,0,0,0.12);
    }
    .age-logo{
      width:190px;
      max-width:70%;
      height:auto;
      display:block;
      margin:0 auto 10px;
    }
    .age-title{font-size:22px;font-weight:900;margin-bottom:8px}
    .age-actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px}
    .age-btn{
      border:1px solid rgba(0,0,0,0.15);
      border-radius:999px;
      padding:12px;
      font-weight:900;
      cursor:pointer;
      background:#fff;
      transition:all .18s ease;
    }
    .age-btn.yes{
      background:var(--black);
      color:#fff;
      border-color:var(--black);
    }
    .age-btn.yes:hover{
      background:#fff;
      color:var(--black);
      border-color:var(--gold);
    }
    .age-btn.no{
      background:#eee;color:#111;border-color:#eee;
    }
    .age-btn.no:hover{
      border-color:var(--gold);
      color:var(--gold);
      background:#fff;
    }
    .age-sub{font-size:12px;color:#666;line-height:1.5;margin:10px 0 0}

    @media(max-width:700px){
      .thumb{width:78px;height:78px;flex-basis:78px}
    }

    @media(max-width:768px){
      .header-inner{grid-template-columns:1fr;gap:10px;justify-items:center;}
      .main-nav{justify-content:center;}
      .header-search{width:100%;}
      .header-search input[type="search"]{width:100%;}
    }

  </style>

  <script src="cart.js"></script>
</head>

<body>

  <!-- Age Gate -->
  <div id="ageGate" class="age-gate">
    <div class="age-card">
      <img src="images/BBE.png" class="age-logo" alt="Bobby Black Exclusive" />
      <div class="age-title">21+ Only</div>
      <p>Please confirm you are 21 years of age or older.</p>
      <div class="age-actions">
        <button class="age-btn yes" id="ageYes">I‚Äôm 21+</button>
        <button class="age-btn no" id="ageNo">No</button>
      </div>
      <p class="age-sub">
        All products, pricing, and descriptions are provided for reference only.
        No transactions, checkout, or delivery occur through this site.
      </p>
    </div>
  </div>
  <header class="site-header">
    <div class="header-inner">
      <a class="brand" href="/">
        <img class="brand-logo" src="images/Bobbyb.png" alt="Bobby Black" />
      </a>

      <nav class="main-nav" aria-label="Primary">
        <a href="brands.html">Brands</a>
        <a href="categories.html">Categories</a>
        <a href="about.html">About</a>
      </nav>

      <form class="header-search" role="search" action="#" method="GET">
        <input
          type="search"
          name="q"
          placeholder="WHAT CAN WE HELP YOU FIND?"
          aria-label="Search"
        />
      </form>
    </div>
  </header>
  <div class="subtitle">Concentrates</div>

  <div class="wrap">
    <a href="index.html" class="back">‚Üê Back to Menu</a>
    <div id="menu"></div>
  </div>

  <footer>
    All products, pricing, and descriptions are provided for reference only.
    No transactions, checkout, or delivery occur through this site. ‚Ä¢ Updated Weekly ‚Ä¢ 21+
  </footer>

  <script>
    // Cart pill
    BBE_CART.mountCartPill();

    // Age gate
    (function(){
      const KEY="bbe_age_verified";
      const gate=document.getElementById("ageGate");
      if(localStorage.getItem(KEY)!=="true"){gate.classList.add("show")}
      document.getElementById("ageYes").onclick=()=>{localStorage.setItem(KEY,"true");gate.classList.remove("show")}
      document.getElementById("ageNo").onclick=()=>{window.location.href="https://www.google.com"}
    })();

    function money(n){ return "$" + Number(n).toFixed(0); }

    // Image filenames (must exist in /images/)
    // Uses item.image from products.json if set, otherwise falls back to this map.
    const IMAGE_MAP = {
      "rosin-budder": "RosinBudder.JPG"
    };

    function getImageForItem(item){
      if(item.image && item.image.trim()) return item.image.trim();
      const file = IMAGE_MAP[item.id];
      if(!file) return "";
      return "images/" + file;
    }

    function showConcentratePrice(item){
      const available = item.availability?.perGram !== false;
      const price = item.prices?.perGram;
      const hasPrice = price !== null && price !== undefined && price !== "";
      if(available && hasPrice) return "1g: " + money(price);
      return "1g: N/A";
    }

    // ‚úÖ One navigation function (keeps View + card click consistent)
    function openProduct(id){
      location.href = "product.html?id=" + encodeURIComponent(id);
    }

    fetch("content/products.json",{cache:"no-store"})
      .then(r=>r.json())
      .then(data=>{
        const items=(data.items||[])
          .filter(i=>i.category==="Concentrates")
          .slice()
          .sort((a,b)=>{
            const ga=(a.subcategory||"Other");
            const gb=(b.subcategory||"Other");
            if(ga!==gb) return ga.localeCompare(gb);
            return (a.name||"").localeCompare(b.name||"");
          });

        const groups={};
        items.forEach(i=>{
          const key=i.subcategory||"Other";
          if(!groups[key]) groups[key]=[];
          groups[key].push(i);
        });

        const container=document.getElementById("menu");
        container.innerHTML = "";

        const groupNames = Object.keys(groups).sort();

        groupNames.forEach(groupName=>{
          const group=document.createElement("div");
          group.className="group";

          const title=document.createElement("div");
          title.className="group-title";
          title.textContent=groupName;
          group.appendChild(title);

          groups[groupName].forEach(item=>{
            const div=document.createElement("div");
            div.className="item";
            div.onclick=()=>openProduct(item.id);

            // Thumbnail
            const thumb=document.createElement("div");
            thumb.className="thumb";
            const imgPath = getImageForItem(item);

            if(imgPath){
              const img=document.createElement("img");
              img.src = imgPath;
              img.alt = item.name;
              img.onerror = () => { thumb.innerHTML = "<div class='noimg'>No Image</div>"; };
              thumb.appendChild(img);
            } else {
              thumb.innerHTML = "<div class='noimg'>No Image</div>";
            }

            div.appendChild(thumb);

            // Main
            const main=document.createElement("div");
            main.className="item-main";

            const name=document.createElement("div");
            name.className="item-name";
            name.textContent=item.name;

            if(item.sale){
              const s=document.createElement("span");
              s.className="sale";
              s.textContent="üö® SALE";
              name.appendChild(s);
            }

            main.appendChild(name);

            const prices=document.createElement("div");
            prices.className="prices";

            const p=document.createElement("span");
            p.className="price";
            p.textContent=showConcentratePrice(item);
            prices.appendChild(p);

            main.appendChild(prices);

            // Actions
            const actions=document.createElement("div");
            actions.className="actions-row";

            const addBtn=document.createElement("button");
            addBtn.className="btn add";
            addBtn.type="button";
            addBtn.textContent="Add";
            addBtn.onclick=(e)=>{
              e.stopPropagation();
              BBE_CART.openAddFlow(item.id, "content/products.json");
            };

            const viewBtn=document.createElement("button");
            viewBtn.className="btn view";
            viewBtn.type="button";
            viewBtn.textContent="View";
            viewBtn.onclick=(e)=>{
              e.stopPropagation();
              openProduct(item.id);
            };

            actions.appendChild(addBtn);
            actions.appendChild(viewBtn);
            main.appendChild(actions);

            div.appendChild(main);
            group.appendChild(div);
          });

          container.appendChild(group);
        });

        if(items.length===0){
          container.innerHTML = "<div style='color:#666;font-weight:900'>No concentrates listed yet.</div>";
        }
      })
      .catch(err=>{
        document.getElementById("menu").innerHTML =
          "<div style='color:#b00000;font-weight:900'>Error loading products.json</div>";
        console.error(err);
      });
  </script>

</body>
</html>
