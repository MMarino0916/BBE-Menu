<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bobby Black Exclusive | Flower</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root{
      --bg:#fafafa;
      --text:#111;
      --muted:#666;
      --card:#fff;
      --border:rgba(0,0,0,0.10);
      --shadow:0 10px 28px rgba(0,0,0,.10);

      /* Luxury accents */
      --gold:#D4AF37;
      --gold-soft:rgba(212,175,55,0.35);
      --black:#0E0E0E;
    }
    *{box-sizing:border-box}
    body{font-family:Arial,sans-serif;margin:0;background:var(--bg);color:var(--text)}

    /* ‚úÖ Full-width black header bar */
    .site-header{
      background:#000;
      width:100%;
      text-align:center;
      padding:28px 16px 22px;
      border-bottom:1px solid var(--gold-soft);
    }
    .brand-logo{
      max-width:260px;
      width:72%;
      margin:0 auto;
      display:block;
    }
    .subtitle{
      margin-top:10px;
      font-size:12px;
      letter-spacing:3px;
      text-transform:uppercase;
      color:var(--gold);
    }

    .wrap{max-width:1100px;margin:0 auto;padding:16px 16px 26px}

    .back{
      display:inline-block;
      margin-bottom:10px;
      text-decoration:none;
      font-weight:900;
      color:#111;
      border-bottom:1px solid transparent;
      transition:color .18s ease, border-color .18s ease;
    }
    .back:hover{color:var(--gold);border-color:var(--gold)}

    .legend{
      font-size:12px;
      color:var(--muted);
      line-height:1.5;
      margin:0 0 14px 0;
    }
    .legend strong{color:#111}
    .legend .sale-dot{color:#b00000;font-weight:900}

    .group{margin-bottom:36px}

    /* ‚úÖ group header now supports an optional logo */
    .group-head{
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
    }
    .group-title{
      font-size:18px;
      font-weight:900;
      border-bottom:2px solid #111;
      display:inline-block;
      padding-bottom:4px;
      margin:0;
    }
    .group-mark{
      width:36px;
      height:36px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#fff;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 6px 18px rgba(0,0,0,.08);
      flex:0 0 36px;
    }
    .group-mark img{
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
      padding:4px;
    }

    .item{
      background:var(--card);
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      border-radius:14px;
      padding:14px;
      margin-top:12px;
      cursor:pointer;
      transition:transform .08s ease, border-color .18s ease;
      display:flex;
      gap:14px;
      align-items:center;
    }
    .item:hover{
      transform:translateY(-2px);
      border-color:var(--gold-soft);
    }
    .item.disabled{
      cursor:default;
      opacity:.9;
    }
    .item.disabled:hover{transform:none}

    .thumb{
      width:92px;height:92px;flex:0 0 92px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#f3f3f3;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      transition:border-color .18s ease;
    }
    .item:hover .thumb{border-color:var(--gold-soft)}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .noimg{
      font-size:11px;
      color:var(--muted);
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:1px;
    }

    .item-main{flex:1 1 auto; min-width:0;}
    .item-name{font-weight:900;font-size:16px}
    .sale{color:#b00000;font-weight:900;margin-left:6px;font-size:13px}

    .prices{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px;font-size:13px}
    .price{
      background:#f4f4f4;
      border:1px solid #eee;
      border-radius:999px;
      padding:6px 10px;
      transition:border-color .18s ease;
      white-space:nowrap;
    }
    .price.na{opacity:.55}
    .item:hover .price{border-color:var(--gold-soft)}

    .actions-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .btn{
      border:1px solid rgba(0,0,0,0.12);
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      cursor:pointer;
      background:#fff;
      transition:all .18s ease;
    }

    .btn.add{
      background:var(--black);
      color:#fff;
      border-color:var(--black);
    }
    .btn.add:hover{
      background:#fff;
      color:var(--black);
      border-color:var(--gold);
    }

    .btn.view{
      background:#eee;
      color:#111;
      border-color:#eee;
    }
    .btn.view:hover{
      background:#fff;
      color:var(--gold);
      border-color:var(--gold);
    }

    .btn.disabled{
      opacity:.5;
      cursor:not-allowed;
    }

    footer{
      text-align:center;
      padding:18px 14px 28px;
      font-size:11px;
      color:#777;
    }

    /* ‚úÖ Age gate */
    .age-gate{
      position:fixed;inset:0;z-index:9999;
      background:rgba(0,0,0,.72);
      display:none;align-items:center;justify-content:center;padding:20px
    }
    .age-gate.show{display:flex}
    .age-card{
      background:#fff;
      max-width:460px;width:100%;
      border-radius:18px;
      padding:22px;
      text-align:center;
      box-shadow:0 20px 60px rgba(0,0,0,.35);
      border:1px solid rgba(0,0,0,0.12);
    }
    .age-logo{
      width:180px;
      max-width:70%;
      height:auto;
      display:block;
      margin:0 auto 10px;
    }
    .age-title{font-size:22px;font-weight:900;margin-bottom:8px}
    .age-actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px}
    .age-btn{
      border:1px solid rgba(0,0,0,0.15);
      border-radius:999px;
      padding:12px;
      font-weight:900;
      cursor:pointer;
      background:#fff;
      transition:all .18s ease;
    }
    .age-btn.yes{
      background:var(--black);
      color:#fff;
      border-color:var(--black);
    }
    .age-btn.yes:hover{
      background:#fff;
      color:var(--black);
      border-color:var(--gold);
    }
    .age-btn.no{
      background:#eee;color:#111;border-color:#eee;
    }
    .age-btn.no:hover{
      border-color:var(--gold);
      color:var(--gold);
      background:#fff;
    }
    .age-sub{font-size:12px;color:#666;line-height:1.5;margin:10px 0 0}

    @media(max-width:700px){
      .brand-logo{width:86%}
      .thumb{width:78px;height:78px;flex-basis:78px}
      .group-mark{width:34px;height:34px;flex-basis:34px}
    }
  </style>

  <script src="cart.js"></script>
</head>

<body>

  <!-- Age Gate -->
  <div id="ageGate" class="age-gate">
    <div class="age-card">
      <img src="images/BBE.png" class="age-logo" alt="Bobby Black Exclusive" />
      <div class="age-title">21+ Only</div>
      <p>Please confirm you are 21 years of age or older.</p>
      <div class="age-actions">
        <button class="age-btn yes" id="ageYes">I‚Äôm 21+</button>
        <button class="age-btn no" id="ageNo">No</button>
      </div>
      <p class="age-sub">
        All products, pricing, and descriptions are provided for reference only.
        No transactions, checkout, or delivery occur through this site.
      </p>
    </div>
  </div>

  <!-- ‚úÖ Black header -->
  <header class="site-header">
    <img src="images/Bobbyb.png" class="brand-logo" alt="Bobby Black Exclusive" />
    <div class="subtitle">Flower Menu</div>
  </header>

  <div class="wrap">
    <a href="index.html" class="back">‚Üê Back to Menu</a>

    <div class="legend">
      (<strong>8th</strong> / <strong>Q</strong> / <strong>Half</strong> / <strong>OZ</strong>) &nbsp; ‚Ä¢ &nbsp;
      (<span class="sale-dot">üö®</span> = <strong>SALE</strong>) &nbsp; ‚Ä¢ &nbsp;
      (<strong>N/A</strong> = <strong>NOT AVAILABLE</strong>)
    </div>

    <div id="menu"></div>
  </div>

  <footer>
    All products, pricing, and descriptions are provided for reference only.
    No transactions, checkout, or delivery occur through this site. ‚Ä¢ 21+
  </footer>

  <script>
    BBE_CART.mountCartPill();

    // Age gate
    (function(){
      const KEY="bbe_age_verified";
      const gate=document.getElementById("ageGate");
      if(localStorage.getItem(KEY)!=="true"){gate.classList.add("show")}
      document.getElementById("ageYes").onclick=()=>{localStorage.setItem(KEY,"true");gate.classList.remove("show")}
      document.getElementById("ageNo").onclick=()=>{window.location.href="https://www.google.com"}
    })();

    // ===== MENU MUST MATCH YOUR MENU IMAGE EXACTLY =====
    // Prices correspond to: 8th(3.5g) / Q(7g) / Half(14g) / OZ(28g)
    const MENU_SPEC = [
      {
        group: "CA$H RULE$",
        groupLogo: "images/CasshrulesOfficial.png",
        items: [
          { name: "Verzace by Bobby Black Exclusive", prices: { g3_5: 40, g7: 80, g14: 140, g28: 260 } },
          { name: "Zaamatic", prices: { g3_5: 30, g7: 50, g14: 100, g28: 180 } },
          { name: "Jelly Fish", prices: { g3_5: 50, g7: 100, g14: 180, g28: 340 } }
        ]
      },
      {
        group: "LOOSE LINEUP",
        items: [
          { name: "Double bubble", prices: { g3_5: 30, g7: 50, g14: 100, g28: 180 } },
          { name: "Pink certz", prices: { g3_5: 25, g7: 45, g14: 90,  g28: 160 } },
          { name: "Space candy", prices: { g3_5: 25, g7: 45, g14: 90,  g28: 160 } },
          { name: "Fruit snacks", prices: { g3_5: 25, g7: 45, g14: 90,  g28: 160 } },
          { name: "Strawberry Gelato", prices: { g3_5: 30, g7: 50, g14: 100, g28: 180 } },
          { name: "Bolo Runtz", prices: { g3_5: 30, g7: 50, g14: 100, g28: 180 } },
          { name: "Sherbert", prices: { g3_5: 25, g7: 40, g14: 80,  g28: 140 } },
          { name: "Gumbo", prices: { g3_5: 25, g7: 40, g14: 80,  g28: 140 } },
          { name: "Peachtree", prices: { g3_5: 30, g7: 50, g14: 100, g28: 180 } },
          { name: "Candy fumez (exotic shake)", prices: { g3_5: 30, g7: 45, g14: 80, g28: 150 } }
        ]
      }
    ];

    // ===== Image map (fallback) =====
    // Uses your existing paths first (item.image from products.json), then these fallbacks.
    const IMAGE_MAP = {
      "zaamatic": "Zaamatic.png",
      "double-bubble": "Double-bubble.png",
      "pink-certz": "Pink-Certz.png",
      "space-candy": "Space-Candy.png",
      "fruit-snacks": "Fruit-Stripes.png",
      "jelly-fish": "JellyFish.JPG",
      "strawberry-gelato": "Strawberry.png",
      "bolo-runtz": "Bolo-Runtz.png",
      "sherbert": "Sherbert.png",
      "candy-fumez-shake": "CandyFumesShake.jpg",
      "sugar-shock": "Sugar-Shock.png",
      "ready-to-trap": "Ready-To-Trap.png",
      "rainbow-belts": "Rainbow-Belts.png",
      "frosted-peaches": "Frosted-Peaches.png",
      "crazzy": "Crazzy.png",
      "adl": "ADL.png"
    };

    function normalizeKey(s){
      return String(s||"").toLowerCase().replace(/[^a-z0-9]/g,"");
    }
    function slugifyName(s){
      return String(s||"")
        .toLowerCase()
        .replace(/\(exotic shake\)/g,"-shake")
        .replace(/\(shake\)/g,"-shake")
        .replace(/[^a-z0-9]+/g,"-")
        .replace(/(^-|-$)/g,"");
    }

    function moneyOrNA(v){
      if(v === "N/A") return "N/A";
      const n = Number(v);
      if(!isFinite(n)) return "N/A";
      return "$" + n.toFixed(0);
    }

    function sizeLabel(k){ return k==="g3_5"?"8th":k==="g7"?"Q":k==="g14"?"Half":"OZ"; }

    function getImageForItem(item){
      if(item && item.image && String(item.image).trim()) return String(item.image).trim();

      if(item && item.id && IMAGE_MAP[item.id]) return "images/" + IMAGE_MAP[item.id];

      if(item && item.name){
        const maybe = IMAGE_MAP[slugifyName(item.name)];
        if(maybe) return "images/" + maybe;
      }
      return "";
    }

    function openProduct(id){
      location.href = "product.html?id=" + encodeURIComponent(id);
    }

    // ===== Render MENU_SPEC, but keep Add/View if item exists in products.json =====
    fetch("content/products.json",{cache:"no-store"})
      .then(r=>r.json())
      .then(data=>{
        const all = (data.items||[]).filter(i => i.category === "Flower");

        const byId = new Map(all.map(i => [i.id, i]));
        const byName = new Map(all.map(i => [normalizeKey(i.name), i]));

        const container=document.getElementById("menu");
        container.innerHTML = "";

        MENU_SPEC.forEach(groupSpec=>{
          const group=document.createElement("div");
          group.className="group";

          const head=document.createElement("div");
          head.className="group-head";

          if(groupSpec.groupLogo){
            const mark=document.createElement("div");
            mark.className="group-mark";
            const img=document.createElement("img");
            img.src = groupSpec.groupLogo;
            img.alt = groupSpec.group + " logo";
            img.onerror = () => { mark.style.display="none"; };
            mark.appendChild(img);
            head.appendChild(mark);
          }

          const title=document.createElement("h2");
          title.className="group-title";
          title.textContent=groupSpec.group;
          head.appendChild(title);
          group.appendChild(head);

          groupSpec.items.forEach(spec=>{
            const keyName = normalizeKey(spec.name);
            const guessId = slugifyName(spec.name);
            const found = byName.get(keyName) || byId.get(guessId) || null;

            const item = found ? found : { id: guessId, name: spec.name };
            const canOpen = !!found;

            const div=document.createElement("div");
            div.className="item" + (canOpen ? "" : " disabled");
            if(canOpen){
              div.onclick=()=>openProduct(item.id);
            }

            const thumb=document.createElement("div");
            thumb.className="thumb";
            const imgPath = getImageForItem(item);

            if(imgPath){
              const img=document.createElement("img");
              img.src = imgPath;
              img.alt = item.name;
              img.loading = "lazy";
              img.onerror = () => { thumb.innerHTML = "<div class='noimg'>No Image</div>"; };
              thumb.appendChild(img);
            } else {
              thumb.innerHTML = "<div class='noimg'>No Image</div>";
            }
            div.appendChild(thumb);

            const main=document.createElement("div");
            main.className="item-main";

            const name=document.createElement("div");
            name.className="item-name";
            name.textContent=spec.name;

            if(spec.sale){
              const s=document.createElement("span");
              s.className="sale";
              s.textContent="üö® SALE";
              name.appendChild(s);
            }
            main.appendChild(name);

            const prices=document.createElement("div");
            prices.className="prices";
            ["g3_5","g7","g14","g28"].forEach(k=>{
              const p=document.createElement("span");
              const val = moneyOrNA(spec.prices[k]);
              p.className="price" + (val === "N/A" ? " na" : "");
              p.textContent = sizeLabel(k) + ": " + val;
              prices.appendChild(p);
            });
            main.appendChild(prices);

            // ‚úÖ EFFECTS REMOVED FROM FLOWER LIST (per your request)

            const actions=document.createElement("div");
            actions.className="actions-row";

            const addBtn=document.createElement("button");
            addBtn.className="btn add" + (canOpen ? "" : " disabled");
            addBtn.type="button";
            addBtn.textContent="Add";
            addBtn.onclick=(e)=>{
              e.stopPropagation();
              if(!canOpen) return;
              BBE_CART.openAddFlow(item.id, "content/products.json");
            };

            const viewBtn=document.createElement("button");
            viewBtn.className="btn view" + (canOpen ? "" : " disabled");
            viewBtn.type="button";
            viewBtn.textContent="View";
            viewBtn.onclick=(e)=>{
              e.stopPropagation();
              if(!canOpen) return;
              openProduct(item.id);
            };

            actions.appendChild(addBtn);
            actions.appendChild(viewBtn);
            main.appendChild(actions);

            div.appendChild(main);
            group.appendChild(div);
          });

          container.appendChild(group);
        });
      })
      .catch(err=>{
        document.getElementById("menu").innerHTML =
          "<div style='color:#b00000;font-weight:900'>Error loading products.json</div>";
        console.error(err);
      });
  </script>

</body>
</html>
